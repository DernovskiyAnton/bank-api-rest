databaseChangeLog:
  - changeSet:
      id: 004-create-indexes
      author: anton-dernovskiy
      changes:
        # Indexes for users table
        - createIndex:
            indexName: idx_users_username
            tableName: users
            columns:
              - column:
                  name: username

        - createIndex:
            indexName: idx_users_email
            tableName: users
            columns:
              - column:
                  name: email

        - createIndex:
            indexName: idx_users_role
            tableName: users
            columns:
              - column:
                  name: role

        # Indexes for cards table
        - createIndex:
            indexName: idx_cards_user_id
            tableName: cards
            columns:
              - column:
                  name: user_id

        - createIndex:
            indexName: idx_cards_status
            tableName: cards
            columns:
              - column:
                  name: status

        - createIndex:
            indexName: idx_cards_user_status
            tableName: cards
            columns:
              - column:
                  name: user_id
              - column:
                  name: status

        - createIndex:
            indexName: idx_cards_expiry_date
            tableName: cards
            columns:
              - column:
                  name: expiry_date

        # Indexes for transactions table
        - createIndex:
            indexName: idx_transactions_from_card
            tableName: transactions
            columns:
              - column:
                  name: from_card_id

        - createIndex:
            indexName: idx_transactions_to_card
            tableName: transactions
            columns:
              - column:
                  name: to_card_id

        - createIndex:
            indexName: idx_transactions_date
            tableName: transactions
            columns:
              - column:
                  name: transaction_date
                  descending: true

        - createIndex:
            indexName: idx_transactions_from_card_date
            tableName: transactions
            columns:
              - column:
                  name: from_card_id
              - column:
                  name: transaction_date
                  descending: true

      rollback:
        - dropIndex:
            indexName: idx_users_username
            tableName: users
        - dropIndex:
            indexName: idx_users_email
            tableName: users
        - dropIndex:
            indexName: idx_users_role
            tableName: users
        - dropIndex:
            indexName: idx_cards_user_id
            tableName: cards
        - dropIndex:
            indexName: idx_cards_status
            tableName: cards
        - dropIndex:
            indexName: idx_cards_user_status
            tableName: cards
        - dropIndex:
            indexName: idx_cards_expiry_date
            tableName: cards
        - dropIndex:
            indexName: idx_transactions_from_card
            tableName: transactions
        - dropIndex:
            indexName: idx_transactions_to_card
            tableName: transactions
        - dropIndex:
            indexName: idx_transactions_date
            tableName: transactions
        - dropIndex:
            indexName: idx_transactions_from_card_date
            tableName: transactions